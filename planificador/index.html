<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Planificador de Materias</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    h1 { color: #006699; }
    select, button { margin: 10px 0; padding: 5px; }
  </style>
</head>
<body>
  <h1>Planificador de materias (máx. 18 créditos)</h1>
  <p>Selecciona tu nivel actual y calcula las materias recomendadas:</p>

  <label for="nivel">Nivel actual:</label>
  <select id="nivel">
    <option value="1">1</option>
    <option value="2">2</option>
    <!-- puedes añadir más niveles -->
  </select>

  <br>
  <button onclick="calcularMaterias()">Calcular</button>

  <h2>Recomendadas para los próximos niveles:</h2>
  <ul id="resultado"></ul>

  <script>
    let materias = [];

    // Cargar el JSON
    fetch('../malla.json')
      .then(res => res.json())
      .then(data => materias = data);

    function calcularMaterias() {
      const nivelActual = parseInt(document.getElementById('nivel').value);
      const maxCreditos = 18;
      const nivelesObjetivo = [nivelActual + 1, nivelActual + 2];

      const materiasDisponibles = materias.filter(m => 
        nivelesObjetivo.includes(m.nivel)
      );

      const aprobadas = materias
        .filter(m => m.nivel <= nivelActual)
        .map(m => m.codigo).filter(c => c && c !== "");

      // Filtra las que se pueden cursar por prerrequisitos
      const candidatas = materiasDisponibles.filter(m =>
        m.prerequisitos.every(req => aprobadas.includes(req))
      );

      let seleccionadas = [];
      let totalCreditos = 0;

      for (const m of candidatas) {
        if (totalCreditos + m.creditos <= maxCreditos) {
          seleccionadas.push(m);
          totalCreditos += m.creditos;
        }
      }

      // Mostrar resultado
      const ul = document.getElementById('resultado');
      ul.innerHTML = '';
      for (const m of seleccionadas) {
        const li = document.createElement('li');
        li.textContent = `${m.nombre} (${m.creditos} créditos)`;
        ul.appendChild(li);
      }
    }
  </script>
</body>
</html>

